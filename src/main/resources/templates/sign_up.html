<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <title>새 할 일 추가</title>
  <th:block th:insert="~{layout :: head}"></th:block>
</head>

<body>
<!-- 공통 js -->
<th:block th:insert="~{layout :: js}"></th:block>

<section id="container">
  <!-- 상단바 -->
  <th:block th:insert="~{layout :: navbar}"></th:block>
  <!-- 사이드바 -->
  <th:block th:insert="~{layout :: sidebar}"></th:block>

  <!-- **********************************************************************************************************************************************************
  MAIN CONTENT
  *********************************************************************************************************************************************************** -->
  <!--main content start-->
  <section id="main-content">
    <!--<section class="wrapper">-->
    <section class="wrapper">
      <h3><i class="fa fa-angle-right"></i> BUSYBUDDY 회원가입</h3><br>

      <!-- BASIC FORM ELELEMNTS -->
      <div class="row mt">
        <div class="col-lg-12">
          <!--<div class="form-panel">-->
          <!--<div class="form-panel" style="max-width: 850px; margin: 0 auto; padding-left: 100px;">-->
          <!--<div class="form-panel" style="max-width: 1060px; margin: 0 auto; padding-left: 110px;">-->
          <div class="form-panel" style="max-width: 1060px; margin: 0 auto; padding-left: 110px;">
            <!--이정도 괜찮은듯?-->
            <h4 class="mb"><i class="fa fa-angle-right"></i> 회원가입 정보</h4><br>
            <form class="form-horizontal style-form" method="get">

              <!-- 아이디 입력 -->
              <div class="form-group">
                <label class="col-sm-2 col-sm-2 control-label">아이디</label>
                <div class="col-sm-4">
                  <input type="text" class="form-control" id="inputUserID" placeholder="아이디 입력">
                </div>
                <div class="col-sm-offset-0">
                  <button type="button" class="btn btn-theme" id="checkDuplicate"
                          data-toggle="modal" data-target="#confirmIDModal">중복체크
                  </button>
                </div>
              </div>

              <!-- 이메일 입력 -->
              <div class="form-group">
                <label class="col-sm-2 col-sm-2 control-label">이메일</label>
                <div class="col-sm-7">
                  <input type="text" class="form-control" id="inputUserEmail" placeholder="이메일 입력">
                </div>
              </div>

              <!-- 닉네임 입력 -->
              <div class="form-group">
                <label class="col-sm-2 col-sm-2 control-label">닉네임</label>
                <div class="col-sm-4">
                  <input type="text" class="form-control" id="inputUserNickname"
                         placeholder="닉네임 입력">
                </div>
              </div>

              <!-- 비밀번호 입력 -->
              <div class="form-group">
                <label class="col-sm-2 col-sm-2 control-label">비밀번호</label>
                <div class="col-sm-7">
                  <input type="password" class="form-control" id="inputUserPassword"
                         placeholder="비밀번호 입력">
                </div>
                <br><br><br>
                <!-- 비밀번호 재입력 -->
                <label class="col-sm-2 col-sm-2 control-label">비밀번호 재입력</label>
                <div class="col-sm-7">
                  <input type="password" class="form-control" id="inputUserConfirmPassword"
                         placeholder="비밀번호 재입력">
                  <span
                      class="help-block">비밀번호는 8문자 이상이어야 하며, 1개 이상의 영문자 & 1개 이상의 특수문자가 포함되어야 합니다.</span>
                </div>
              </div>

              <div class="form-group">
                <!-- 회원가입 버튼 -->
                <div class="col-sm-offset-2 col-sm-7 text-center">
                  <button type="button" class="btn btn-warning btn-lg btn-block" id="Signup"
                          data-toggle="modal" data-target="#confirmSignupModal">회원가입
                  </button>
                  <!--
                  <button type="submit" class="btn btn-theme">회원가입</button>
                  <button type="button" class="btn btn-primary btn-lg btn-block">회원가입</button>
                  <button type="button" class="btn btn-warning btn-lg btn-block">회원가입</button>
                  -->
                </div>
              </div>
            </form>
          </div>
        </div><!-- col-lg-12-->
      </div><!-- /row -->

      <!-- INPUT MESSAGES -->
      <!-- 올바르지 않은 정보 입력시 빨간색으로 바뀌는 등 가능... 추후 추가하기;-->
      <!--<div class="row mt">
        <div class="col-lg-12">
          <div class="form-panel">
                <h4 class="mb"><i class="fa fa-angle-right"></i> Input Messages</h4>
                    <form class="form-horizontal tasi-form" method="get">
                        <div class="form-group has-success">
                            <label class="col-sm-2 control-label col-lg-2" for="inputSuccess">Input with success</label>
                            <div class="col-lg-10">
                                <input type="text" class="form-control" id="inputSuccess">
                            </div>
                        </div>
                        <div class="form-group has-warning">
                            <label class="col-sm-2 control-label col-lg-2" for="inputWarning">Input with warning</label>
                            <div class="col-lg-10">
                                <input type="text" class="form-control" id="inputWarning">
                            </div>
                        </div>
                        <div class="form-group has-error">
                            <label class="col-sm-2 control-label col-lg-2" for="inputError">Input with error</label>
                            <div class="col-lg-10">
                                <input type="text" class="form-control" id="inputError">
                            </div>
                        </div>
                    </form>
          </div>&lt;!&ndash; /form-panel &ndash;&gt;
        </div>&lt;!&ndash; /col-lg-12 &ndash;&gt;-->
      </div><!-- /row -->
    </section>
  </section>
  <!--main content end-->
  <!-- 푸터 -->
  <th:block th:insert="~{layout :: footer}"></th:block>
</section>

<!-- 아이디 중복 확인 모달 -->
<div id="confirmIdModalContainer" th:replace="/confirm_Id_modal :: confirmIdModal"></div>
<!-- 회원가입 확인 모달 -->
<div id="confirmSignUpModalContainer" th:replace="/confirm_sign_up_modal :: confirmSignupModal"></div>


<!-- 아이디 중복체크 시 1일 때 아이디 사용불가 모달 표시, 아닐때 아이디를 사용할수 없음 모달 표시 -->
<script>
  $(document).ready(function () {
    TaskList.initTaskWidget();

    $('#checkDuplicate').on('click', function () {
      var enteredId = $('#inputUserID').val();
      if (enteredId === "1") {
        $('#modalMessage').html('<p>이미 사용중인 아이디입니다.</p>'); // 1이 아닐 때 모달 내용 설정
        $('#useIdButton').hide(); // 사용하기 버튼 숨기기
      } else {
        $('#modalMessage').html('<p>사용 가능한 아이디입니다. 해당 아이디를 사용하시겠습니까?</p>'); // 1일 때 모달 내용 설정
        $('#useIdButton').show(); // 사용하기 버튼 숨기기
      }
      //$('#confirmIDModal').modal('show'); // 모달 보이기
    });

    // 사용하기 버튼 클릭 시 입력된 아이디를 회원가입 페이지로 이동하고 아이디를 전달하는 함수

    $('#Signup').on('click', function () {

      var id = $('#inputUserID').val();
      var email = $('#inputUserEmail').val();
      var nickname = $('#inputUserNickname').val();
      var password = $('#inputUserPassword').val();
      var confirmPassword = $('#inputUserConfirmPassword').val();

      // 필수 입력 사항이 입력되었는지 확인
      if (id === '' || email === '' || nickname === '' || password === '' || confirmPassword
          === '') {
        $('#SignupModalMessage').html('<p>입력되지 않은 내용이 있습니다. 입력 내용을 다시 확인해 주세요.</p>');
        $('#CancelButton').show();
        $('#SignupButton').hide();
        return;
      }

      // 아이디가 1인 경우 사용할 수 없는 아이디입니다. (임시)
      // 아이디가 기존에 가입된 아이디와 중복되면 사용할 수 없는 아이디로 뜨게 조건 수정하기!
      if (id === '1') {
        $('#SignupModalMessage').html('<p>사용할 수 없는 아이디입니다.</p>');
        $('#CancelButton').show();
        $('#SignupButton').hide();
        return;
      }

      // 비밀번호와 비밀번호 재입력이 일치하는지 확인
      if (password !== confirmPassword) {
        $('#SignupModalMessage').html('<p>비밀번호가 일치하지 않습니다. 비밀번호를 다시 확인해 주세요.</p>');
        $('#CancelButton').show();
        $('#SignupButton').hide();
        return;
      }

      var passwordPattern = /^(?=.*[a-zA-Z])(?=.*[!@#$%^&*]).{8,}$/;
      if (!passwordPattern.test(password)) {
        $('#SignupModalMessage').html('<p>비밀번호가 문법에 맞게 작성되지 않았습니다. 비밀번호를 다시 확인해 주세요.</p>');
        $('#CancelButton').show();
        $('#SignupButton').hide();
        return;
      }

      // 회원가입 진행
      // 여기에 회원가입 로직을 추가하세요.

      // 회원가입이 성공적으로 완료되면 다음 모달을 표시하거나 다른 처리를 수행하세요.
      /*$('#SignupModalMessage').html('<p>BusyBuddy 에 가입하신 ' + nickname + ' 님을 환영합니다!<br> 지금 바로 할일을 작성하러 가보실까요?</p>');*/
      $('#SignupModalMessage').html(
          '<p>' + nickname + ' 님의 BusyBuddy 가입을 진심으로 환영합니다!<br> 지금 바로 할일을 작성하러 가보실까요?</p>');
      $('#SignupButton').show(); // 회원가입 버튼 표시
      $('#CancelButton').hide();

      // 회원가입이 성공적으로 진행되었으므로 모달의 제목을 '회원가입 완료'로 변경합니다.
      $('#SignupModalLabel').text('회원가입 완료');

      // 회원가입이 성공적으로 완료되면 다음 모달을 표시하거나 다른 처리를 수행하세요.
    });
  });
</script>

</body>
</html>
